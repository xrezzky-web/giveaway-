<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>XREZZKYSTORE RNG</title>
<style>
body{
 background:#0b0b0b;
 color:#fff;
 font-family:Arial;
 text-align:center;
}

#wheelBox{
 position:relative;
 width:300px;
 height:300px;
 margin:20px auto;
}

/* RODA */
#canvas{
 width:100%;
 height:100%;
 border-radius:50%;
 transition:transform 4s cubic-bezier(0.25,0.1,0.25,1);
}

/* PANAH SVG ‚¨áÔ∏è (ANTI KETIBAN) */
#arrow{
 position:absolute;
 top:-10px;
 left:50%;
 transform:translateX(-50%);
 width:40px;
 height:40px;
 z-index:99999;
 pointer-events:none;
}

input,button{
 padding:8px;
 margin:5px;
 border-radius:6px;
 border:none;
}

button{
 background:#25d366;
 color:#000;
 font-weight:bold;
 cursor:pointer;
}

#log{
 max-width:300px;
 margin:15px auto;
 text-align:left;
 font-size:13px;
}
</style>
</head>

<body>

<h2>XREZZKYSTORE GIVEAWAY</h2>

<div id="wheelBox">

 <!-- PANAH SVG -->
 <svg id="arrow" viewBox="0 0 100 100">
  <polygon points="50,90 10,20 90,20" fill="#ff2e2e"/>
 </svg>

 <canvas id="canvas" width="300" height="300"></canvas>
</div>

<input id="name" placeholder="Nama kamu">
<br>
<button onclick="spin()">SPIN</button>

<p id="result"></p>
<button id="claimBtn" style="display:none" onclick="claim()">KLAIM HADIAH</button>

<h3>Pemenang</h3>
<div id="log"></div>

<script>
const prizes = ["ZONK","50K","100K","Diamond","ZONK"];
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let rot = 0;
let lock = false;

const deviceId = localStorage.getItem("id") || crypto.randomUUID();
localStorage.setItem("id",deviceId);

const hasWon = JSON.parse(localStorage.getItem("hasWon")||"{}");
const winners = JSON.parse(localStorage.getItem("winners")||"[]");

/* DRAW */
function draw(){
 const ang = 2*Math.PI/prizes.length;
 prizes.forEach((p,i)=>{
  ctx.beginPath();
  ctx.moveTo(150,150);
  ctx.arc(150,150,150,i*ang,(i+1)*ang);
  ctx.fillStyle=i%2?"#222":"#444";
  ctx.fill();
  ctx.save();
  ctx.translate(150,150);
  ctx.rotate(i*ang+ang/2);
  ctx.fillStyle="#fff";
  ctx.fillText(p,60,5);
  ctx.restore();
 });
}
draw();

/* SPIN (LOGIC ASLI, AMAN) */
function spin(){
 if(lock) return;
 if(hasWon[deviceId]) return alert("Kamu sudah menang!");

 const name=document.getElementById("name").value.trim();
 if(!name) return alert("Isi nama!");

 const anglePer = 360/prizes.length;
 const index = Math.floor(Math.random()*prizes.length);

 const target = 270 - (index*anglePer) - anglePer/2;
 rot += 360*6 + (target - (rot%360));

 lock=true;
 canvas.style.transform=`rotate(${rot}deg)`;

 setTimeout(()=>{
  lock=false;
  const prize = prizes[index];

  hasWon[deviceId]=true;
  winners.push({name,prize});
  localStorage.setItem("hasWon",JSON.stringify(hasWon));
  localStorage.setItem("winners",JSON.stringify(winners));

  document.getElementById("result").innerText =
   `üéâ ${name} mendapatkan: ${prize}`;

  document.getElementById("claimBtn").style.display="inline-block";
  renderLog();
 },4200);
}

function renderLog(){
 document.getElementById("log").innerHTML =
  winners.map(w=>`‚Ä¢ ${w.name} ‚Üí ${w.prize}`).join("<br>");
}
renderLog();

function claim(){
 const res=document.getElementById("result").innerText;
 const msg=encodeURIComponent(
  "Halo admin, saya mau klaim hadiah:\n"+res
 );
 window.open("https://wa.me/6288293064112?text="+msg);
}
</script>

</body>
</html>
